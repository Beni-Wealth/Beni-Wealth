<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover"/>
  <title>Beni-Wealth — Memory Flip)</title>

  <!-- Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300,400,600,700&display=swap" rel="stylesheet"/>

  <!-- Favicons & Social preview -->
  <link rel="icon" type="image/png" sizes="32x32" href="https://res.cloudinary.com/dq7fpxfbc/image/upload/v1752962852/file_00000000401861f8bf6acb6d55fcf2bf_g2fcrf.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://res.cloudinary.com/dq7fpxfbc/image/upload/v1752962852/file_00000000401861f8bf6acb6d55fcf2bf_g2fcrf.png">
  <meta name="msapplication-TileImage" content="https://res.cloudinary.com/dq7fpxfbc/image/upload/v1752962852/file_00000000401861f8bf6acb6d55fcf2bf_g2fcrf.png">
  <meta name="theme-color" content="#2fe0b8">
  <meta property="og:type" content="website">
  <meta property="og:title" content="Beni-Wealth — Memory Flip">
  <meta property="og:description" content="Match pairs to score. Win to earn ₦50. Entry fee: ₦20.">
  <meta property="og:image" content="https://res.cloudinary.com/dq7fpxfbc/image/upload/c_fill,w_1200,h_630/v1752962852/file_00000000401861f8bf6acb6d55fcf2bf_g2fcrf.png">
  <meta name="twitter:card" content="summary_large_image">

  <style>
    /* … (all your existing CSS exactly as before) … */
  </style>
</head>
<body>
  <!-- … (all your existing HTML UI exactly as before) … -->

  <script type="module">
    import { initializeApp, getApps, getApp } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js";
    import { getAuth, onAuthStateChanged } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js";
    import { getFirestore, doc, getDoc, collection, runTransaction, serverTimestamp, setDoc } from "https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js";

    const firebaseConfig = {
      apiKey: "AIzaSyDy_L7uJeoaWXbUB-LVk_fBv8yHeRjNjZk",
      authDomain: "beni-wealths.firebaseapp.com",
      projectId: "beni-wealths",
      storageBucket: "beni-wealths.firebasestorage.app",
      messagingSenderId: "807950483822",
      appId: "1:807950483822:web:e10fa87307e041c4d8417f",
      measurementId: "G-Z2XP3YN6NS"
    };
    const app = getApps().length ? getApp() : initializeApp(firebaseConfig);
    const auth = getAuth(app);
    const db = getFirestore(app);

    // UI refs
    const playBtn = document.getElementById('playBtn');
    const backBtn = document.getElementById('backBtn');
    const restartBtn = document.getElementById('restartBtn');
    const balanceEl = document.getElementById('balance');
    const boardEl = document.getElementById('board');
    const playerScoreEl = document.getElementById('playerScore');
    const botScoreEl = document.getElementById('botScore');
    const gamelog = document.getElementById('gamelog');
    const turnIndicator = document.getElementById('turnIndicator');
    const modal = document.getElementById('modal');
    const modalTitle = document.getElementById('modalTitle');
    const modalBody = document.getElementById('modalBody');
    const modalClose = document.getElementById('modalClose');
    const gameNote = document.getElementById('gameNote');

    // (all helper functions, music logic, balance refresh, setupTiles, renderBoard, updateScores, user click logic — unchanged)

    // ******************
    // NEW BOT LOGIC
    // ******************
    async function botTurn(){
      if(remainingPairs <= 0) return;

      turn = 'bot';
      lockBoard = true;
      setStatus("Bot is thinking...");
      await sleep(650);

      // 10% chance bot forgets what it saw
      if(Math.random() < 0.10){
        botMemory = {};
        log(`<div style="color:orange">Bot got confused and forgot cards!</div>`);
      }

      // 50% chance to even try memory
      if(Math.random() < 0.5){
        for(const val in botMemory){
          const idxs = Array.from(botMemory[val]).filter(i => !tiles[i].matched);
          if(idxs.length >= 2){
            if(Math.random() < 0.6){
              await botFlipSequence(idxs[0], idxs[1]);
              return;
            }
          }
        }
      }

      // small chance to combine known + random guess
      if(Math.random() < 0.4){
        for(const val in botMemory){
          const idxs = Array.from(botMemory[val]).filter(i => !tiles[i].matched);
          if(idxs.length === 1){
            const knownIdx = idxs[0];
            const unseen = tiles.map((t,i) => i).filter(i => !tiles[i].matched && !tiles[i].flipped);
            if(unseen.length > 0){
              const pick = unseen[Math.floor(Math.random()*unseen.length)];
              await botFlipSequence(knownIdx, pick);
              return;
            }
          }
        }
      }

      // fallback: pick two random unseen
      const unseenTiles = tiles.map((t,i) => i).filter(i => !tiles[i].matched && !tiles[i].flipped);
      if(unseenTiles.length === 0){
        turn = 'player';
        lockBoard = false;
        setStatus("Your turn");
        return;
      }
      let a = unseenTiles[Math.floor(Math.random()*unseenTiles.length)];
      let left = unseenTiles.filter(i => i !== a);
      let b = left[Math.floor(Math.random()*left.length)];
      await botFlipSequence(a,b);
    }

    async function botFlipSequence(i1, i2){
      await sleep(350);
      flipTile(i1, 'bot');
      await sleep(700);
      flipTile(i2, 'bot');
    }
    function sleep(ms){ return new Promise(r=>setTimeout(r,ms)); }

    // ******************
    // (everything else exactly as in your original script —
    // including checkMatch(), finishGame(), playBtn logic, auth, initEmpty, etc.)
    // ******************

  </script>
</body>
</html>
