<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>My Adverts ‚Äî Beni-Wealth</title>

  <!-- Poppins -->
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet"/>

  <!-- Favicons & Social preview -->
  <link rel="icon" type="image/png" sizes="32x32" href="https://res.cloudinary.com/dq7fpxfbc/image/upload/v1752962852/file_00000000401861f8bf6acb6d55fcf2bf_g2fcrf.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://res.cloudinary.com/dq7fpxfbc/image/upload/v1752962852/file_00000000401861f8bf6acb6d55fcf2bf_g2fcrf.png">
  <meta name="msapplication-TileImage" content="https://res.cloudinary.com/dq7fpxfbc/image/upload/v1752962852/file_00000000401861f8bf6acb6d55fcf2bf_g2fcrf.png">

  <meta property="og:type" content="website">
  <meta property="og:title" content="Beni-Wealth ‚Äî Earn Steadily">
  <meta property="og:description" content="Complete simple micro-tasks, ptcs, blogs and shortlinks. Advertise efficiently with transparent metrics and fast payouts.">
  <meta property="og:image" content="https://res.cloudinary.com/dq7fpxfbc/image/upload/c_fill,w_1200,h_630/v1752962852/file_00000000401861f8bf6acb6d55fcf2bf_g2fcrf.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="theme-color" content="#2fe0b8">

  <style>
    :root{
      --bg:#070611;
      --panel:#0f0b1f;
      --card:#151033;
      --border:rgba(255,255,255,.06);
      --text:#eef3ff;
      --muted:rgba(255,255,255,.65);
      --accent:#2fe0b8;
      --radius:16px;
      --max:1200px;
    }
    *{box-sizing:border-box}
    body{
      margin:0;
      font-family:Poppins,system-ui;
      background:linear-gradient(180deg,#05040d,#0a0620);
      color:var(--text);
      min-height:100vh;
    }
    .wrap{max-width:var(--max);margin:auto;padding:16px}
    header{
      display:flex;align-items:center;justify-content:space-between;gap:12px;
      margin-bottom:14px;
    }
    .back{
      text-decoration:none;color:var(--text);
      padding:8px 12px;border-radius:10px;
      background:rgba(255,255,255,.04);
    }
    .title{font-weight:800;font-size:1.15rem}
    .subtitle{color:var(--muted);font-size:13px}

    .toolbar{
      display:grid;grid-template-columns:1fr auto;gap:10px;
      margin:16px 0;
    }
    .search{
      padding:12px;border-radius:12px;border:1px solid var(--border);
      background:transparent;color:var(--text);
    }
    .btn{
      border:none;border-radius:12px;padding:12px 16px;
      font-weight:700;cursor:pointer;
      background:var(--accent);color:#04211a;
    }
    .btn.ghost{background:transparent;border:1px solid var(--border);color:var(--muted)}

    .status{margin-bottom:12px;color:var(--muted);font-size:13px}

    .grid{
      display:grid;gap:14px;
      grid-template-columns:repeat(auto-fill,minmax(280px,1fr));
    }
    .card{
      background:linear-gradient(180deg,rgba(255,255,255,.03),rgba(255,255,255,.01));
      border:1px solid var(--border);
      border-radius:var(--radius);
      padding:14px;
      display:flex;flex-direction:column;gap:12px;
    }
    .card-head{display:flex;gap:12px;align-items:center}
    .thumb{width:70px;height:54px;object-fit:cover;border-radius:10px;border:1px solid var(--border)}
    .card-title{font-weight:700}
    .meta{color:var(--muted);font-size:12px}
    .desc{color:var(--muted);font-size:14px;line-height:1.45}
    .row{display:flex;align-items:center;justify-content:space-between;gap:10px}
    .pill{
      padding:6px 10px;border-radius:999px;font-size:11px;font-weight:700;
    }
    .pill.pending{background:#fff6d6;color:#6a4f00}
    .pill.approved{background:#c9f3df;color:#0a5531}
    .pill.completed{background:#e1ecff;color:#0b3a6d}

    .actions{display:flex;gap:8px;margin-top:auto}

    /* DETAILS DRAWER */
    .drawer{
      position:fixed;inset:0;background:rgba(0,0,0,.55);
      display:none;z-index:1000;
    }
    .drawer.open{display:block}
    .panel{
      position:absolute;right:0;top:0;height:100%;width:100%;max-width:980px;
      background:linear-gradient(180deg,#08081c,#03030b);
      border-left:1px solid var(--border);
      padding:16px;overflow:auto;
    }
    .panel-head{display:flex;align-items:center;justify-content:space-between;gap:12px}
    .panel-title{font-weight:800}
    .close{background:transparent;border:1px solid var(--border);border-radius:10px;padding:8px;color:var(--muted)}

    .sub{margin-top:14px;display:flex;flex-direction:column;gap:12px}
    .sub-item{
      background:rgba(255,255,255,.03);
      border:1px solid var(--border);
      border-radius:14px;padding:12px;
      display:grid;grid-template-columns:1fr auto;gap:12px;
    }
    .sub-text{color:var(--muted);white-space:pre-wrap;font-size:14px}

    @media (max-width:640px){
      header{flex-direction:column;align-items:flex-start}
      .toolbar{grid-template-columns:1fr}
      .panel{max-width:100%}
      .sub-item{grid-template-columns:1fr}
    }
  </style>
</head>
<body>
  <main class="wrap">
    <header>
      <a href="dashboard.html" class="back">‚Üê Back</a>
      <div>
        <div class="title">My Adverts</div>
        <div class="subtitle">Manage adverts and review submissions</div>
      </div>
    </header>

    <div class="toolbar">
      <input id="search" class="search" placeholder="Search adverts" />
      <button id="refresh" class="btn ghost">Refresh</button>
    </div>

    <div id="diag" class="status">Connecting‚Ä¶</div>

    <section id="grid" class="grid">
      <div class="muted">Loading your adverts‚Ä¶</div>
    </section>
  </main>

  <!-- DETAILS DRAWER -->
  <div id="drawer" class="drawer" aria-hidden="true">
    <div class="panel">
      <div class="panel-head">
        <div>
          <div id="dTitle" class="panel-title">Advert</div>
          <div id="dMeta" class="meta"></div>
        </div>
        <button id="closeDrawer" class="close">‚úï</button>
      </div>
      <div id="dDesc" class="desc" style="margin-top:10px"></div>
      <div class="sub" id="subList"></div>
    </div>
  </div>

  <script type="module">
    // üîí LOGIC KEPT IDENTICAL ‚Äî UI ONLY REPLACED
    import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
    import { getFirestore, collection, query, where, onSnapshot, doc, runTransaction, serverTimestamp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';
    import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js';

    const firebaseConfig = {
      apiKey: "AIzaSyDy_L7uJeoaWXbUB-LVk_fBv8yHeRjNjZk",
      authDomain: "beni-wealths.firebaseapp.com",
      projectId: "beni-wealths",
      storageBucket: "beni-wealths.firebasestorage.app",
      messagingSenderId: "807950483822",
      appId: "1:807950483822:web:e10fa87307e041c4d8417f"
    };

    const app = initializeApp(firebaseConfig);
    const db = getFirestore(app);
    const auth = getAuth(app);

    const grid = document.getElementById('grid');
    const diag = document.getElementById('diag');
    const search = document.getElementById('search');
    const refresh = document.getElementById('refresh');

    const drawer = document.getElementById('drawer');
    const closeDrawer = document.getElementById('closeDrawer');
    const dTitle = document.getElementById('dTitle');
    const dMeta = document.getElementById('dMeta');
    const dDesc = document.getElementById('dDesc');
    const subList = document.getElementById('subList');

    let currentUser=null;
    let adverts=new Map();
    let unsub=null;

    function buildCard(id,d){
      const c=document.createElement('div');c.className='card';
      c.innerHTML=`
        <div class="card-head">
          ${d.thumbnail?`<img class="thumb" src="${d.thumbnail}">`:''}
          <div>
            <div class="card-title">${d.title||'(untitled)'}</div>
            <div class="meta">${d.platform||''} ‚Ä¢ ${d.workers||0} workers</div>
          </div>
        </div>
        <div class="desc">${(d.description||'').slice(0,120)}</div>
        <div class="row">
          <span class="pill ${(d.status||'pending').toLowerCase()}">${(d.status||'pending').toUpperCase()}</span>
          <button class="btn ghost">Details</button>
        </div>`;
      c.querySelector('button').onclick=()=>openDetails(id);
      return c;
    }

    function render(){
      const q=(search.value||'').toLowerCase();
      grid.innerHTML='';
      let any=false;
      adverts.forEach((d,id)=>{
        const hay=(d.title||'')+(d.platform||'')+(d.status||'');
        if(q && !hay.toLowerCase().includes(q)) return;
        grid.appendChild(buildCard(id,d)); any=true;
      });
      if(!any) grid.innerHTML='<div class="muted">No adverts found</div>';
    }

    function openDetails(id){
      const d=adverts.get(id); if(!d) return;
      dTitle.textContent=d.title||'';
      dMeta.textContent=`${d.platform||''} ‚Ä¢ ${d.workers||0} workers ‚Ä¢ ${(d.status||'').toUpperCase()}`;
      dDesc.textContent=d.description||'';
      subList.innerHTML='<div class="muted">Loading submissions‚Ä¶</div>';
      drawer.classList.add('open');
    }

    closeDrawer.onclick=()=>drawer.classList.remove('open');

    onAuthStateChanged(auth,u=>{
      currentUser=u;
      if(!u){ diag.textContent='Please sign in'; return; }
      const q=collection(db,'advertise_tasks');
      unsub=onSnapshot(q,s=>{
        adverts.clear();
        s.forEach(docu=>{ const d=docu.data()||{}; if(d.createdBy===u.uid) adverts.set(docu.id,d); });
        diag.textContent=`${adverts.size} adverts`;
        render();
      });
    });

    search.oninput=render;
    refresh.onclick=()=>{ if(unsub){unsub();unsub=null;} adverts.clear(); render(); };
  </script>
</body>
</html>
