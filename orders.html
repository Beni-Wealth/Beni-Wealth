<!doctype html>

<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>My Adverts — Beni-Wealth</title>

  <!-- Poppins -->

  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet" />

  <!-- Favicons & Social preview -->

  <link rel="icon" type="image/png" sizes="32x32" href="https://res.cloudinary.com/dq7fpxfbc/image/upload/v1752962852/file_00000000401861f8bf6acb6d55fcf2bf_g2fcrf.png">
  <link rel="apple-touch-icon" sizes="180x180" href="https://res.cloudinary.com/dq7fpxfbc/image/upload/v1752962852/file_00000000401861f8bf6acb6d55fcf2bf_g2fcrf.png">

  <meta property="og:type" content="website">
  <meta property="og:title" content="Beni-Wealth — Earn Steadily">
  <meta property="og:description" content="Manage adverts and review submissions">
  <meta property="og:image" content="https://res.cloudinary.com/dq7fpxfbc/image/upload/c_fill,w_1200,h_630/v1752962852/file_00000000401861f8bf6acb6d55fcf2bf_g2fcrf.png">
  <meta name="twitter:card" content="summary_large_image">
  <meta name="theme-color" content="#2fe0b8">

  <style>
    body{margin:0;font-family:Poppins,system-ui;background:#05040d;color:#eef3ff}
    .wrap{max-width:1200px;margin:auto;padding:16px}
    .back{color:#eef3ff;text-decoration:none;margin-bottom:12px;display:inline-block}
    .title{font-size:1.2rem;font-weight:700}
    .status{margin:12px 0;color:rgba(255,255,255,.7)}
    .grid{display:grid;grid-template-columns:repeat(auto-fill,minmax(260px,1fr));gap:14px}
    .card{background:#0f0b1f;border-radius:14px;padding:14px}
    .empty{opacity:.7}
  </style>

</head>
<body>

<main class="wrap">
  <a href="dashboard.html" class="back">← Dashboard</a>
  <div class="title">My Adverts</div>
  <div id="status" class="status">Initializing…</div>
  <section id="grid" class="grid"></section>
</main>

<script type="module">
  import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
  import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js';
  import { getFirestore, collection, query, where, getDocs } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';

  const firebaseConfig = {
    apiKey: "AIzaSyDy_L7uJeoaWXbUB-LVk_fBv8yHeRjNjZk",
    authDomain: "beni-wealths.firebaseapp.com",
    projectId: "beni-wealths",
    storageBucket: "beni-wealths.firebasestorage.app",
    messagingSenderId: "807950483822",
    appId: "1:807950483822:web:e10fa87307e041c4d8417f",
    measurementId: "G-Z2XP3YN6NS"
  };

  const app = initializeApp(firebaseConfig);
  const auth = getAuth(app);
  const db = getFirestore(app);

  const status = document.getElementById('status');
  const grid = document.getElementById('grid');

  function card(data){
    const d=document.createElement('div');
    d.className='card';
    d.innerHTML=`<strong>${data.title||'Untitled advert'}</strong><br><small>${data.platform||''}</small>`;
    return d;
  }

  onAuthStateChanged(auth, async user => {
    if(!user){
      window.location.href='login.html';
      return;
    }

    status.textContent='Loading adverts…';

    try{
      const q = query(collection(db,'advertise_tasks'), where('createdBy','==',user.uid));
      const snap = await getDocs(q);

      if(snap.empty){
        status.textContent='No adverts found';
        grid.innerHTML='<div class="empty">You have not created any adverts yet.</div>';
        return;
      }

      status.textContent=`${snap.size} adverts found`;
      snap.forEach(doc => grid.appendChild(card(doc.data())));

    }catch(err){
      console.error(err);
      status.textContent='Failed to load adverts (check console)';
    }
  });
</script>

</body>
</html>
