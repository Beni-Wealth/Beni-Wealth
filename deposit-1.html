<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>Deposit ‚Äî SAQ 1 ¬∑ Beni‚ÄëWealth</title>
  <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;600;700&display=swap" rel="stylesheet">
  <meta name="theme-color" content="#2fe0b8">

  <style>
    :root{
      --bg-1:#0b0613; --bg-2:#0f0820;
      --text:#eaf2ff; --muted:rgba(255,255,255,0.62);
      --accent-a:#8446ff; --accent-b:#6ce2c8;
      --glass: rgba(255,255,255,0.03);
      --container-w:820px; --radius:18px; --bottom-nav-h:74px;
      font-family: 'Poppins', system-ui, -apple-system, 'Segoe UI', Roboto, Arial;
    }

    *{box-sizing:border-box}
    html,body{height:100%;margin:0}
    body{
      min-height:100%;
      background:
        radial-gradient(700px 350px at 10% 8%, rgba(132,70,255,0.06), transparent),
        radial-gradient(700px 350px at 90% 92%, rgba(44,220,185,0.04), transparent),
        linear-gradient(180deg,var(--bg-1),var(--bg-2));
      color:var(--text);
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
      display:flex;justify-content:center;padding:26px;
    }

    .phone{
      width:100%;max-width:var(--container-w);border-radius:22px;padding:20px 20px calc(var(--bottom-nav-h) + 64px);background: linear-gradient(180deg, rgba(255,255,255,0.012), rgba(255,255,255,0.008));box-shadow: 0 28px 90px rgba(0,0,0,0.65);overflow:auto;
    }

    header{display:flex;align-items:center;justify-content:space-between;gap:12px;margin-bottom:14px}
    .brand{display:flex;gap:12px;align-items:center}
    .brand img{width:64px;height:64px;border-radius:12px;object-fit:cover}
    .brand .title{font-weight:800;font-size:16px}
    .brand .sub{font-size:12px;color:var(--muted)}

    h1{margin:6px 0 8px;font-size:18px}
    .lead{color:var(--muted);font-size:14px;margin-bottom:12px}

    .card{border-radius:16px;padding:18px;background: linear-gradient(180deg, rgba(255,255,255,0.015), rgba(255,255,255,0.01));border:1px solid rgba(255,255,255,0.03);box-shadow: 0 18px 60px rgba(0,0,0,0.45)}

    .provider{display:flex;gap:14px;align-items:center}
    .provider .badge{width:72px;height:72px;border-radius:14px;background:linear-gradient(90deg,var(--accent-b),var(--accent-a));display:grid;place-items:center;color:#041219;font-weight:900;font-size:20px}
    .provider .meta{display:flex;flex-direction:column}
    .provider .meta .bank{font-weight:900;color:var(--accent-b);font-size:16px}
    .provider .meta .acc{font-weight:800;color:var(--accent-b);font-size:15px;margin-top:6px}
    .provider .meta .note{color:var(--muted);font-size:13px;margin-top:4px}

    form{margin-top:14px;display:flex;flex-direction:column;gap:12px}
    .row{display:flex;gap:12px;align-items:center}
    label{min-width:150px;color:var(--muted);font-weight:700}
    input[type='text'], input[type='number'], input[type='file']{flex:1;padding:10px 12px;border-radius:12px;border:1px solid rgba(255,255,255,0.04);background:rgba(255,255,255,0.02);color:var(--text);font-weight:600}
    input[readonly]{background:transparent;border:0;color:var(--muted)}
    .controls{display:flex;gap:10px;align-items:center}
    .btn{padding:10px 14px;border-radius:12px;border:none;cursor:pointer;background:linear-gradient(90deg,var(--accent-b),var(--accent-a));color:#041219;font-weight:800}
    .btn.ghost{background:transparent;border:1px solid rgba(255,255,255,0.04);color:var(--muted)}

    .small{font-size:13px;color:var(--muted)}
    .status{margin-top:8px;color:var(--muted);min-height:20px}
    .status.error{color:#ffb3b3}
    .status.success{color:#bff0d9}

    progress{width:100%;height:8px;border-radius:6px;overflow:hidden}

    /* bottom nav */
    .bw-bottom-nav{position:fixed;left:50%;transform:translateX(-50%);bottom:18px;height:var(--bottom-nav-h);width:calc(min(var(--container-w),100%) - 24px);max-width:var(--container-w);background: linear-gradient(90deg, rgba(255,255,255,0.03), rgba(255,255,255,0.02));border-radius:38px;padding:10px 14px;display:flex;align-items:center;justify-content:space-between;gap:10px;box-shadow: 0 18px 60px rgba(0,0,0,0.45);border:1px solid rgba(255,255,255,0.04);z-index:999;backdrop-filter: blur(6px)}
    .nav-btn{ width:56px; text-align:center; color:var(--muted); font-size:11px; display:flex; flex-direction:column; align-items:center; gap:6px; cursor:pointer }
    .icon-wrap{ width:44px; height:44px; border-radius:10px; display:grid; place-items:center; background: rgba(255,255,255,0.02); font-size:18px }
    .nav-center .center-btn{ width:82px;height:82px;border-radius:50%;background:linear-gradient(135deg,var(--accent-b),var(--accent-a));display:grid;place-items:center;color:#041219;font-size:26px;transform:translateY(-22px) }

    @media(max-width:760px){ .phone{padding-bottom:calc(var(--bottom-nav-h) + 80px)} label{min-width:120px} .provider .meta .bank{font-size:15px} }
  </style>
</head>
<body>
  <main class="phone" role="main" aria-labelledby="title">
    <header>
      <div class="brand">
        <img src="https://res.cloudinary.com/dq7fpxfbc/image/upload/v1752962852/file_00000000401861f8bf6acb6d55fcf2bf_g2fcrf.png" alt="Beni‚ÄëWealth logo">
        <div>
          <div class="title">Beni‚ÄëWealth</div>
          <div class="sub">Deposit ‚Äî SAQ 1</div>
        </div>
      </div>

      <div style="text-align:right; color:var(--muted); font-size:13px">Need help? <a href="mailto:beniwealth70@gmail.com" style="color:var(--accent-b); text-decoration:underline">beniwealth70@gmail.com</a></div>
    </header>

    <section class="card" aria-labelledby="title">
      <h1 id="title">Send payment ‚Äî SAQ 1</h1>
      <p class="lead">Use the account below for bank/mobile transfers. After payment, upload proof here so we can verify and credit your account.</p>

      <div class="provider">
        <div class="badge">BANK</div>
        <div class="meta">
          <div class="bank">Moniepoint</div>
          <div class="acc">Beinmote Benjamin Owana‚ÄëOmubo</div>
          <div class="acc">5792230881</div>
          <div class="note">Use exact account name & number. For quick verification, include transaction reference in your message.</div>
        </div>
      </div>

      <form id="depositForm" onsubmit="return false" aria-describedby="hint">
        <div class="row">
          <label for="depositorName">Your account name</label>
          <input id="depositorName" name="depositorName" type="text" placeholder="Name on your bank/mobile" required />
        </div>

        <div class="row">
          <label for="amount">Amount (‚Ç¶)</label>
          <input id="amount" name="amount" type="number" placeholder="e.g. 1500" min="1" required />
        </div>

        <div class="row" style="align-items:flex-start">
          <label for="proofFile">Upload proof</label>
          <div style="flex:1;display:flex;flex-direction:column;gap:8px">
            <input id="proofFile" name="proofFile" type="file" accept="image/*" aria-label="Upload proof image" />
            <div class="small">Accepted: JPG/PNG. Max recommended 8MB.</div>
            <progress id="uploadProgress" value="0" max="100" style="display:none"></progress>
          </div>
        </div>

        <div class="controls">
          <button id="submitBtn" class="btn" type="button">Submit deposit</button>
          <button id="clearBtn" class="btn ghost" type="button">Clear</button>
        </div>

        <div id="status" class="status" aria-live="polite"></div>

        <div id="hint" class="small">After submission our team will usually verify within a few hours. Check your deposit history for status updates.</div>
      </form>
    </section>

    <footer style="text-align:center;margin-top:12px;color:rgba(255,255,255,0.35)">¬© <span id="year"></span> Beni‚ÄëWealth</footer>
  </main>

  <nav class="bw-bottom-nav" role="navigation" aria-label="Main navigation">
    <div id="navHome" class="nav-btn"><div class="icon-wrap">üè†</div><div style="font-size:11px;color:var(--muted)">Home</div></div>
    <div id="navShortlinks" class="nav-btn"><div class="icon-wrap">üîó</div><div style="font-size:11px;color:var(--muted)">Shortlinks</div></div>
    <div style="flex:0 0 92px;display:flex;justify-content:center;align-items:center"><button id="navCreate" class="center-btn nav-center" aria-label="Create">‚ûï</button></div>
    <div id="navNews" class="nav-btn"><div class="icon-wrap">üí¨</div><div style="font-size:11px;color:var(--muted)">News</div></div>
    <div id="navAssets" class="nav-btn"><div class="icon-wrap">üë§</div><div style="font-size:11px;color:var(--muted)">Assets</div></div>
  </nav>

  <script type="module">
    // repo helper
    const REPO_BASE = '/Beni-Wealth';
    function withRepoPath(target){ if(!target) return location.href; try{ const maybe = new URL(target, location.href); if(maybe.origin === location.origin){ const pathname = maybe.pathname.replace(/\/+/g,'/'); if(pathname.indexOf(REPO_BASE) === 0) return maybe.origin + pathname + maybe.search + maybe.hash;} return maybe.href;}catch(e){} const clean = String(target).replace(/^\/+/,''); const repoClean = REPO_BASE.replace(/^\/+/,''); if(clean.indexOf(repoClean)===0) return location.origin + '/' + clean; return location.origin + REPO_BASE + (clean ? '/' + clean : ''); }

    // Imgur upload helper - lightweight base64 upload
    async function uploadToImgur(file, onProgress){
      const clientId = 'fb533db21a59486';
      const endpoint = 'https://api.imgur.com/3/image';
      return new Promise((resolve,reject)=>{
        const reader = new FileReader();
        reader.onload = ()=>{
          const base64 = reader.result.split(',')[1];
          const form = new FormData(); form.append('image', base64); form.append('type','base64');
          const xhr = new XMLHttpRequest(); xhr.open('POST', endpoint);
          xhr.setRequestHeader('Authorization','Client-ID '+clientId);
          xhr.upload.onprogress = evt => { if(evt.lengthComputable) onProgress(Math.round(evt.loaded/evt.total*100)); };
          xhr.onload = ()=>{ try{ const res = JSON.parse(xhr.responseText); if(res && res.success) resolve(res.data.link); else reject(res.data?.error || 'Imgur upload failed'); }catch(e){ reject('Invalid JSON from Imgur'); }};
          xhr.onerror = ()=> reject('Network error uploading to Imgur'); xhr.send(form);
        };
        reader.onerror = ()=> reject('File read error'); reader.readAsDataURL(file);
      });
    }

    // Firebase modular imports
    import { initializeApp, getApps } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-app.js';
    import { getAuth, onAuthStateChanged } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-auth.js';
    import { getFirestore, collection, addDoc, serverTimestamp } from 'https://www.gstatic.com/firebasejs/9.23.0/firebase-firestore.js';

    const firebaseConfig = {
      apiKey: "AIzaSyDy_L7uJeoaWXbUB-LVk_fBv8yHeRjNjZk",
      authDomain: "beni-wealths.firebaseapp.com",
      projectId: "beni-wealths",
      storageBucket: "beni-wealths.firebasestorage.app",
      messagingSenderId: "807950483822",
      appId: "1:807950483822:web:e10fa87307e041c4d8417f",
      measurementId: "G-Z2XP3YN6NS"
    };

    if(!getApps().length) initializeApp(firebaseConfig);
    const auth = getAuth();
    const db = getFirestore();

    // DOM refs
    const depositorName = document.getElementById('depositorName');
    const amountInput = document.getElementById('amount');
    const proofFile = document.getElementById('proofFile');
    const submitBtn = document.getElementById('submitBtn');
    const clearBtn = document.getElementById('clearBtn');
    const statusEl = document.getElementById('status');
    const uploadProgress = document.getElementById('uploadProgress');

    // provider info (display-only)
    const PROVIDER = { providerName:'Moniepoint', accountNumber:'5792230881', accountName:'Beinmote Benjamin Owana-Omubo' };

    function setStatus(msg, type){ statusEl.textContent = msg || ''; statusEl.className = 'status' + (type? ' '+type : ''); }

    clearBtn.addEventListener('click', ()=>{
      depositorName.value = ''; amountInput.value = ''; proofFile.value = ''; uploadProgress.value = 0; uploadProgress.style.display = 'none'; setStatus('');
    });

    onAuthStateChanged(auth, (user)=>{
      const right = document.querySelector('header .brand + div');
      if(!user){ if(right) right.textContent = 'Not signed in'; return; }
      if(right) right.textContent = user.displayName || (user.email ? user.email.split('@')[0] : 'User');
    });

    submitBtn.addEventListener('click', async (e)=>{
      e.preventDefault(); setStatus('');
      const file = proofFile.files && proofFile.files[0];
      const depositor = (depositorName.value || '').trim();
      const amount = Number(amountInput.value || 0);

      if(!depositor){ setStatus('Please enter the account name used for the transfer.', 'error'); return; }
      if(!amount || amount <= 0){ setStatus('Please enter a valid amount.', 'error'); return; }
      if(!file){ setStatus('Please upload a proof image before submitting.', 'error'); return; }

      submitBtn.disabled = true; submitBtn.textContent = 'Uploading proof...'; uploadProgress.style.display = 'block'; uploadProgress.value = 0;

      try{
        const imgUrl = await uploadToImgur(file, (pct)=>{ uploadProgress.value = pct; });
        setStatus('Image uploaded ‚Äî saving deposit record...');

        const user = auth.currentUser;
        const depositDoc = {
          userId: user ? user.uid : null,
          username: user ? (user.displayName || (user.email ? user.email.split('@')[0] : null)) : null,
          provider: PROVIDER.providerName,
          providerAccountNumber: PROVIDER.accountNumber,
          providerAccountName: PROVIDER.accountName,
          accountNameEntered: depositor,
          amount: amount,
          proofUrl: imgUrl,
          status: 'pending',
          createdAt: serverTimestamp()
        };

        await addDoc(collection(db,'deposits'), depositDoc);

        setStatus('Deposit submitted. We will verify and credit your account shortly.', 'success');
        depositorName.value = ''; amountInput.value = ''; proofFile.value = ''; uploadProgress.value = 0; uploadProgress.style.display = 'none';
      }catch(err){ console.error('submit error',err); setStatus('Error submitting deposit: ' + (err.message || err), 'error'); }
      finally{ submitBtn.disabled = false; submitBtn.textContent = 'Submit deposit'; }
    });

    // bottom nav wiring
    document.getElementById('navHome').addEventListener('click',(e)=>{e.preventDefault(); location.assign(withRepoPath('catalog.html'));});
    document.getElementById('navShortlinks').addEventListener('click',(e)=>{e.preventDefault(); location.assign(withRepoPath('convert.html'));});
    document.getElementById('navCreate').addEventListener('click',(e)=>{e.preventDefault(); location.assign(withRepoPath('center.html'));});
    document.getElementById('navNews').addEventListener('click',(e)=>{e.preventDefault(); location.assign(withRepoPath('news.html'));});
    document.getElementById('navAssets').addEventListener('click',(e)=>{e.preventDefault(); location.assign(withRepoPath('dashboard.html'));});

    // ensure padding
    (function ensurePadding(){ const main = document.querySelector('.phone'); const nav = document.querySelector('.bw-bottom-nav'); if(!main||!nav) return; const need = (nav.getBoundingClientRect().height||72)+32; const cur = parseInt(getComputedStyle(main).paddingBottom)||0; if(cur < need) main.style.paddingBottom = need + 'px'; })();

    document.getElementById('year').textContent = new Date().getFullYear();
  </script>
</body>
</html>
